<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Leagues — Inter Manila</title>
<style>
body{
  margin:0;
  font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background:#0f172a;
  color:#f1f5f9;
}
.header{
  background:#020617;
  padding:18px;
  font-size:24px;
  font-weight:bold;
  text-align:center;
  border-bottom:2px solid #334155;
}
.container{
  max-width:600px;
  margin:auto;
  padding:20px;
}
input{
  width:100%;
  padding:10px;
  margin:6px 0 12px 0;
  border-radius:8px;
  border:none;
  background:#1e293b;
  color:white;
  font-size:14px;
}
button{
  padding:12px;
  width:100%;
  border:none;
  border-radius:10px;
  background:#2563eb;
  color:white;
  font-weight:bold;
  cursor:pointer;
  margin-bottom:12px;
  transition:0.2s;
}
button:hover{
  background:#1d4ed8;
}
.league-card{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#1e293b;
  padding:12px 15px;
  border-radius:10px;
  margin-bottom:10px;
}
.league-card input{
  flex:1;
  margin-right:10px;
}
.delete-btn{
  background:#ef4444;
}
.delete-btn:hover{
  background:#dc2626;
}
.back{
  margin-top:20px;
  display:block;
  text-align:center;
  color:#93c5fd;
  text-decoration:none;
}
</style>
</head>
<body>

<div class="header">Leagues — Inter Manila</div>

<div class="container">
<input type="text" id="newLeagueName" placeholder="New League Name">
<button onclick="addLeague()">Add League</button>

<div id="leaguesContainer">Loading leagues...</div>

<a class="back" href="dashboard.html">← Back to Dashboard</a>

<div id="message"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, updateDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyAuqUcXYjMU-XaL_w7h4y43RHku4dQGFlk",
  authDomain: "inter-manila.firebaseapp.com",
  projectId: "inter-manila",
  storageBucket: "inter-manila.firebasestorage.app",
  messagingSenderId: "285507279342",
  appId: "1:285507279342:web:5aa0c80a08fb92727416ff"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

/* Protect page */
onAuthStateChanged(auth,(user)=>{
  if(!user) window.location.href="index.html";
});

/* Load leagues */
async function loadLeagues(){
  const snapshot = await getDocs(collection(db,"leagues"));
  let html="";
  snapshot.forEach(docSnap=>{
    html += `
      <div class="league-card">
        <input type="text" value="${docSnap.data().name}" id="name_${docSnap.id}">
        <button onclick="updateLeague('${docSnap.id}')" >Save</button>
        <button class="delete-btn" onclick="deleteLeague('${docSnap.id}')">Delete</button>
      </div>
    `;
  });
  document.getElementById("leaguesContainer").innerHTML = html;
}

/* Add League */
window.addLeague = async function(){
  const name = document.getElementById("newLeagueName").value.trim();
  if(!name) return alert("Enter league name");
  await addDoc(collection(db,"leagues"),{name});
  document.getElementById("newLeagueName").value="";
  loadLeagues();
}

/* Update League */
window.updateLeague = async function(id){
  const newName = document.getElementById(`name_${id}`).value.trim();
  if(!newName) return alert("Enter league name");
  const ref = doc(db,"leagues",id);
  await updateDoc(ref,{name:newName});
  loadLeagues();
}

/* Delete League */
window.deleteLeague = async function(id){
  if(!confirm("Are you sure you want to delete this league?")) return;
  await deleteDoc(doc(db,"leagues",id));
  loadLeagues();
}

loadLeagues();
</script>
</body>
</html>
