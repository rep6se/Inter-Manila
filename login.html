<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Inter Manila â€” Admin Suite</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <style>
        :root {
            /* Premium Dark Theme */
            --bg-body: #050505;
            --bg-card: #121212;
            --bg-glass: rgba(18, 18, 18, 0.85);
            --bg-surface: #1e1e22;
            
            /* Accents */
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --accent-glow: rgba(59, 130, 246, 0.4);
            
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --gold: #FFD700;
            --silver: #C0C0C0;
            --bronze: #CD7F32;
            
            /* Text */
            --text-main: #ffffff;
            --text-sec: #a1a1aa;
            --text-dim: #52525b;

            /* Borders & Effects */
            --border: 1px solid rgba(255, 255, 255, 0.08);
            --border-light: 1px solid rgba(255, 255, 255, 0.15);
            --radius-sm: 8px;
            --radius-md: 14px;
            --radius-lg: 20px;
            --shadow-card: 0 10px 30px -10px rgba(0,0,0,0.5);
        }

        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; }

        body { 
            margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: var(--bg-body);
            color: var(--text-main); 
            min-height: 100vh; padding-bottom: 100px;
            background-image: radial-gradient(circle at 50% 0%, #1a2236 0%, transparent 60%);
            background-attachment: fixed;
        }
        
        body.loading { overflow: hidden; }
        body.loading > *:not(#loadingScreen) { display: none; }

        /* === SCROLLBAR === */
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #3f3f46; border-radius: 10px; }

        /* === UTILS === */
        .hidden { display: none !important; }
        button, input, select { font-family: inherit; }

        /* === CUSTOM DROPDOWN / FILTER STYLING === */
        .filter-wrapper {
            position: relative;
            display: inline-block;
        }
        
        .custom-select {
            appearance: none;
            background: rgba(255, 255, 255, 0.05);
            border: var(--border);
            color: var(--text-main);
            padding: 10px 40px 10px 16px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            backdrop-filter: blur(10px);
            min-width: 140px;
        }

        .custom-select:hover, .custom-select:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--text-sec);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .filter-icon {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-sec);
            pointer-events: none;
            font-size: 10px;
        }

        /* === LOADING SCREEN === */
        #loadingScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-body);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10000;
        }
        .loader { 
            width: 45px; height: 45px; border: 3px solid rgba(59, 130, 246, 0.2);
            border-top-color: var(--primary); border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        #loadingText { margin-top: 20px; font-size: 11px; color: var(--text-sec); font-weight: 700; letter-spacing: 2px; text-transform: uppercase; }

        /* === LOGIN OVERLAY === */
        #loginOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            display: flex; align-items: center; justify-content: center;
            z-index: 10002; padding: 20px;
        }
        .login-card {
            background: var(--bg-card); border: var(--border-light);
            padding: 40px 30px; border-radius: 24px; text-align: center;
            width: 100%; max-width: 380px; 
            box-shadow: 0 40px 80px -20px rgba(0, 0, 0, 0.8);
        }
        .logo-area img { width: 64px; margin-bottom: 20px; filter: drop-shadow(0 0 15px rgba(59,130,246,0.3)); }
        
        input, select {
            width: 100%; padding: 14px 16px 14px 45px; background: var(--bg-surface);
            border: 1px solid transparent; color: #fff; border-radius: var(--radius-md);
            font-size: 14px; transition: 0.2s; font-weight: 500;
        }
        input:focus { border-color: var(--primary); background: #000; }
        
        .btn-login, .btn-add, .btn-save {
            width: 100%; padding: 14px; 
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white; border: none; border-radius: var(--radius-md); font-weight: 700;
            cursor: pointer; font-size: 14px; 
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.4); transition: 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-login:active, .btn-add:active { transform: scale(0.98); }

        /* === HEADER & NAV === */
        header { 
            text-align: center; padding: 50px 0 25px; 
            position: relative;
        }
        header h1 { margin: 10px 0 0; font-size: 18px; font-weight: 800; letter-spacing: -0.5px; }

        .logout-btn { 
            position: absolute; top: 25px; right: 25px; color: var(--danger); 
            background: rgba(239, 68, 68, 0.1); width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 10px;
            font-size: 12px; cursor: pointer; transition: 0.2s;
        }

        nav { 
            display: flex; justify-content: center; padding: 10px; gap: 6px; 
            background: rgba(30, 30, 34, 0.6); backdrop-filter: blur(16px);
            position: sticky; top: 15px; z-index: 100; border-radius: 50px; border: var(--border-light);
            margin: 0 auto 30px; width: fit-content; max-width: 95%;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
        }
        nav a { 
            color: var(--text-sec); padding: 10px 18px; border-radius: 40px; 
            font-size: 12px; font-weight: 700; display: flex; align-items: center; gap: 8px; 
            transition: 0.3s; cursor: pointer; text-decoration: none;
        }
        nav a:hover { color: #fff; background: rgba(255,255,255,0.05); }
        nav a.active { background: #fff; color: #000; box-shadow: 0 2px 10px rgba(255,255,255,0.2); }
        nav a i { font-size: 13px; }

        .container { max-width: 600px; margin: 0 auto; padding: 0 20px; }

        /* === DASHBOARD === */
        .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .welcome-box h2 { font-size: 22px; font-weight: 800; margin: 0; color: #fff; }
        .welcome-box p { color: var(--primary); font-size: 12px; font-weight: 600; margin-top: 4px; }

        .stats-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .stat-card { 
            background: var(--bg-card); border-radius: var(--radius-lg); padding: 20px; 
            border: var(--border); display: flex; flex-direction: column; 
            align-items: flex-start; justify-content: center; position: relative; overflow: hidden;
            box-shadow: var(--shadow-card);
        }
        .stat-card h3 { margin: 0; font-size: 11px; text-transform: uppercase; color: var(--text-sec); font-weight: 700; letter-spacing: 0.5px; }
        .stat-card .val { font-size: 28px; font-weight: 800; margin: 8px 0 0; color: #fff; letter-spacing: -1px; }
        .full-card { grid-column: span 2; flex-direction: row; align-items: center; justify-content: space-between; padding-right: 25px; background: linear-gradient(135deg, #1c1c20 0%, #121212 100%); }

        /* Form Dots */
        .form-dots { display: flex; gap: 6px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; }
        .dot-W { background: var(--success); box-shadow: 0 0 8px rgba(16, 185, 129, 0.5); }
        .dot-L { background: var(--danger); box-shadow: 0 0 8px rgba(239, 68, 68, 0.5); }
        .dot-D { background: var(--text-dim); }

        /* Recent Activity */
        .recent-section { margin-top: 30px; }
        .section-title { font-size: 12px; color: var(--text-sec); text-transform: uppercase; letter-spacing: 1px; font-weight: 800; margin-bottom: 15px; display:flex; align-items:center; gap:8px; }
        
        .activity-item { 
            display: flex; justify-content: space-between; align-items: center;
            padding: 16px; background: var(--bg-card); margin-bottom: 8px;
            border-radius: var(--radius-md); border: var(--border);
            transition: 0.2s;
        }
        .activity-item:hover { transform: translateX(5px); border-color: rgba(255,255,255,0.2); }
        .team-info b { font-size: 14px; color: #fff; display: block; margin-bottom: 4px; }
        .team-info small { font-size: 11px; color: var(--primary); font-weight: 600; background: rgba(59,130,246,0.1); padding: 2px 6px; border-radius: 4px; }
        .score-pill { 
            padding: 6px 12px; border-radius: 10px; font-weight: 800; font-size: 14px; 
            background: #000; min-width: 55px; text-align: center; border: var(--border);
        }

        /* === SQUAD === */
        .player-card { 
            background: var(--bg-card); border-radius: var(--radius-md); padding: 16px; 
            margin-bottom: 10px; border: var(--border); 
            display: flex; align-items: center; justify-content: space-between;
        }
        .player-card.inactive { opacity: 0.6; filter: grayscale(1); background: transparent; border-style: dashed; }
        .p-name { font-size: 15px; font-weight: 700; color: #fff; display: block; }
        .pos-badge { 
            display: inline-block; background: rgba(255,255,255,0.05); color: var(--text-sec);
            font-size: 10px; font-weight: 700; padding: 3px 8px; border-radius: 6px; 
            margin-top: 6px; margin-right: 4px;
        }
        .player-actions { display: flex; gap: 8px; }
        .player-actions i { 
            width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;
            border-radius: 8px; background: var(--bg-surface); color: var(--text-sec);
            cursor: pointer; font-size: 12px; transition: 0.2s;
        }
        .player-actions i:hover { background: #fff; color: #000; }

        /* === MATCH CARDS === */
        .match-card { 
            background: var(--bg-card); border-radius: var(--radius-lg); padding: 25px; 
            margin-bottom: 20px; border: var(--border); position: relative;
            box-shadow: var(--shadow-card);
        }
        .match-actions { position: absolute; top: 20px; right: 20px; display: flex; gap: 8px; }
        .match-actions i { width:28px; height:28px; display:flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.05); border-radius: 8px; cursor: pointer; color: var(--text-sec); font-size: 12px; transition: 0.2s; }
        .match-actions i:hover { background: #fff; color: #000; }
        
        .league-tag { 
            display: inline-block; color: var(--primary);
            font-size: 10px; font-weight: 700; padding: 4px 10px; border-radius: 20px; 
            text-transform: uppercase; margin-bottom: 15px; background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.2);
        }
        .score-row { display: flex; justify-content: space-between; align-items: center; margin: 10px 0 20px; }
        .team-name { font-weight: 700; font-size: 14px; color: var(--text-sec); flex: 1; text-transform: uppercase; letter-spacing: 0.5px; }
        .agg-score { font-size: 32px; font-weight: 800; color: #fff; margin: 0 20px; letter-spacing: -1px; text-shadow: 0 0 20px rgba(255,255,255,0.1); }
        
        .stats-box { background: #080808; padding: 15px; border-radius: var(--radius-md); border: var(--border); }
        .stat-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #1f1f1f; font-size: 12px; }
        .stat-item:last-child { border: none; padding-bottom: 0; }
        .stat-item b { color: #fff; margin-left: 5px; }
        .stat-player i.fa-medal { color: var(--success); margin-left: 6px; text-shadow: 0 0 10px rgba(16, 185, 129, 0.4); }
        .stat-player i.fa-crown { color: var(--gold); margin-left: 6px; text-shadow: 0 0 10px rgba(255, 215, 0, 0.4); }

        /* === MODALS MODERNIZED === */
        .modal { 
            display: none; position: fixed; inset: 0; z-index: 2000; 
            background: rgba(0,0,0,0.85); backdrop-filter: blur(15px);
            align-items: center; justify-content: center; padding: 20px;
        }
        .modal.active { display: flex; animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        
        .modal-content { 
            background: #121212; width: 100%; max-width: 500px; 
            border-radius: 28px; padding: 30px; border: var(--border-light);
            max-height: 90vh; overflow-y: auto; box-shadow: 0 40px 80px -20px rgba(0,0,0,0.8);
            display: flex; flex-direction: column;
        }
        .modal h3 { margin: 0 0 25px; text-align: center; font-size: 16px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; color: #fff; }
        
        .score-input-group { display: flex; gap: 15px; align-items: center; margin-bottom: 25px; justify-content: center; }
        .score-input-group input { 
            text-align: center; font-size: 32px; font-weight: 800; padding: 15px 0; 
            width: 80px; background: #000; border: var(--border); border-radius: 16px; height: auto;
        }
        .score-input-group input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(59,130,246,0.1); }
        
        .player-picker-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 8px; max-height: 200px; overflow-y: auto; margin-bottom: 25px; padding: 10px; border-radius: var(--radius-md); background: #080808; border: var(--border); }
        .p-chip { 
            padding: 10px; background: #1a1a1e; border-radius: 10px; cursor: pointer;
            border: 1px solid transparent; font-size: 11px; text-align: center;
            transition: 0.2s; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 4px;
        }
        .p-chip:hover { background: #27272a; }
        .p-chip.selected { background: rgba(59, 130, 246, 0.2); border-color: var(--primary); color: #fff; }
        .p-chip b { color: var(--primary); font-size: 10px; background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 4px; }
        .p-chip.selected b { color: #fff; background: var(--primary); }

        /* === PREMIUM HERO SELECTION (MOTM/MVP) === */
        .hero-selection-container {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;
            padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);
        }
        .hero-box {
            position: relative;
        }
        .hero-box label {
            display: flex; align-items: center; gap: 6px; font-size: 10px; font-weight: 700; 
            margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;
        }
        .hero-select-wrapper {
            position: relative;
            background: #080808; border-radius: 12px; border: var(--border);
            height: 50px; display: flex; align-items: center; padding: 0 10px;
            transition: 0.2s;
        }
        .hero-select-wrapper:focus-within {
            border-color: #fff; background: #1a1a1a;
        }
        .hero-box select {
            position: absolute; inset: 0; opacity: 0; width: 100%; height: 100%; cursor: pointer; z-index: 2;
        }
        .hero-display {
            display: flex; align-items: center; gap: 10px; width: 100%; z-index: 1; pointer-events: none;
        }
        .hero-icon {
            width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-size: 14px; flex-shrink: 0;
        }
        .hero-name {
            font-size: 12px; font-weight: 600; color: var(--text-sec); white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        /* MVP Style */
        .hero-box.mvp .hero-icon { background: rgba(255, 215, 0, 0.15); color: var(--gold); border: 1px solid rgba(255, 215, 0, 0.3); }
        .hero-box.mvp .hero-select-wrapper:focus-within { border-color: var(--gold); box-shadow: 0 0 15px rgba(255, 215, 0, 0.1); }
        .hero-box.mvp .hero-name.active { color: var(--gold); }
        
        /* MOTM Style */
        .hero-box.motm .hero-icon { background: rgba(16, 185, 129, 0.15); color: var(--success); border: 1px solid rgba(16, 185, 129, 0.3); }
        .hero-box.motm .hero-select-wrapper:focus-within { border-color: var(--success); box-shadow: 0 0 15px rgba(16, 185, 129, 0.1); }
        .hero-box.motm .hero-name.active { color: var(--success); }

        /* === STATS INPUT === */
        .stats-input-area { 
            background: #080808; padding: 15px; border-radius: var(--radius-md); 
            margin-bottom: 20px; border: var(--border); max-height: 240px; overflow-y: auto; 
        }
        .stat-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; border-bottom: 1px solid #1f1f1f; padding-bottom: 12px; }
        .stat-row:last-child { margin-bottom: 0; border-bottom: none; padding-bottom: 0; }
        .stat-row span { flex: 1; font-size: 13px; font-weight: 600; }
        .stat-row input { 
            width: 45px; padding: 8px 0; text-align: center; font-size: 13px; 
            background: #1a1a1e; border: 1px solid transparent; border-radius: 8px;
        }
        .stat-row input:focus { background: #000; border-color: var(--primary); }

        .btn-cancel { background: transparent; color: var(--text-sec); margin-top: 10px; box-shadow: none; border: var(--border); }
        .btn-cancel:hover { background: rgba(255,255,255,0.05); color: #fff; }
        
        /* === RECORDS === */
        .tab-nav { display: flex; background: var(--bg-card); padding: 5px; border-radius: 12px; margin-bottom: 20px; border: var(--border); }
        .tab-btn { flex: 1; padding: 10px; border: none; background: none; color: var(--text-sec); font-weight: 700; font-size: 11px; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .tab-btn.active { background: #27272a; color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        
        .record-row { 
            display: flex; align-items: center; padding: 16px; 
            background: var(--bg-card); border-radius: 16px; margin-bottom: 8px;
            border: var(--border); position: relative; overflow: hidden;
        }
        .bar { position: absolute; left: 0; top: 0; bottom: 0; background: linear-gradient(90deg, rgba(59, 130, 246, 0.15), transparent); z-index: 0; }
        .rank { width: 30px; font-size: 12px; font-weight: 800; color: var(--text-dim); z-index: 1; }
        .rec-name { flex: 1; font-weight: 700; font-size: 14px; z-index: 1; }
        .rec-val { font-weight: 800; font-size: 16px; color: var(--primary); z-index: 1; }

        /* Page Logic */
        .page-section { display: none; opacity: 0; transition: opacity 0.3s; padding-bottom: 40px; }
        .page-section.active { display: block; opacity: 1; }

    </style>
</head>
<body class="loading">

    <!-- LOGIN -->
    <div id="loginOverlay">
        <div class="login-card">
            <div class="logo-area">
                <img src="inter-milan-old.png" alt="Logo">
                <h1 style="color:#fff; margin:0; font-size:24px; font-weight:800;">Admin Access</h1>
                <p style="color:var(--text-sec); font-size:12px; margin-top:5px;">Secure Dashboard Entry</p>
            </div>
            <div id="loginError" style="display:none; color: var(--danger); font-size: 12px; margin-bottom: 15px; background: rgba(239, 68, 68, 0.1); padding: 10px; border-radius: 8px;"></div>
            <form id="loginForm">
                <div style="margin-bottom:15px; text-align:left;">
                    <div style="position:relative;">
                        <i class="fa fa-envelope" style="position:absolute; left:16px; top:50%; transform:translateY(-50%); color:var(--text-dim);"></i>
                        <input type="email" id="loginEmail" placeholder="Email" required>
                    </div>
                </div>
                <div style="margin-bottom:20px; text-align:left;">
                    <div style="position:relative;">
                        <i class="fa fa-lock" style="position:absolute; left:16px; top:50%; transform:translateY(-50%); color:var(--text-dim);"></i>
                        <input type="password" id="loginPassword" placeholder="Password" required>
                    </div>
                </div>
                <button type="submit" class="btn-login" id="loginButton">Sign In</button>
            </form>
        </div>
    </div>

    <!-- LOADING -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <div id="loadingText">Syncing Data...</div>
    </div>

    <!-- DELETE CONFIRMATION -->
    <div id="deleteModal" class="modal">
        <div class="modal-content" style="max-width:320px; text-align:center;">
            <div style="width:60px; height:60px; background:rgba(239, 68, 68, 0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 20px;">
                <i class="fa-solid fa-trash" style="font-size:24px; color:var(--danger);"></i>
            </div>
            <h2 id="modalTitle" style="margin:0 0 10px; color:#fff; font-size:18px;">Delete Data?</h2>
            <p id="modalMessage" style="color:var(--text-sec); font-size:13px; margin:0 0 25px;">This action cannot be undone.</p>
            <div style="display:flex; gap:10px;">
                <button onclick="closeDeleteModal()" style="flex:1; padding:12px; border-radius:12px; border:var(--border); background:transparent; color:white; cursor:pointer; font-weight:700;">Cancel</button>
                <button id="confirmDeleteBtn" style="flex:1; padding:12px; border-radius:12px; border:none; background:var(--danger); color:white; cursor:pointer; font-weight:700;">Delete</button>
            </div>
        </div>
    </div>

    <header>
        <img src="inter-milan-old.png" alt="Logo" width="45">
        <h1>INTER MANILA</h1>
        <div class="logout-btn" id="logoutBtn"><i class="fa fa-power-off"></i></div>
    </header>

    <nav>
        <a class="active" onclick="navigateAdmin('dashboard')"><i class="fa fa-grid-2"></i> Overview</a>
        <a onclick="navigateAdmin('squad')"><i class="fa fa-users"></i> Squad</a>
        <a onclick="navigateAdmin('matches')"><i class="fa fa-futbol"></i> Matches</a>
        <a onclick="navigateAdmin('records')"><i class="fa fa-trophy"></i> Stats</a>
    </nav>

    <!-- ========== DASHBOARD ========== -->
    <div id="dashboardPage" class="page-section active">
        <div class="container">
            <div class="dashboard-header">
                <div class="welcome-box"><h2>Club Stats</h2><p id="seasonLabel">All-Time Records</p></div>
                <!-- IMPROVED FILTER BUTTON -->
                <div class="filter-wrapper">
                    <select id="dashboardFilter" class="custom-select"><option value="all">All Seasons</option></select>
                    <i class="fa fa-chevron-down filter-icon"></i>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card full-card">
                    <div>
                        <h3>Win Rate</h3>
                        <span class="val" id="dashWinRate" style="color:var(--primary)">0%</span>
                    </div>
                    <div class="form-dots" id="dashForm"></div>
                </div>
                
                <div class="stat-card"><h3>Matches</h3><span class="val" id="dashMatches">0</span><div class="stat-sub" id="dashWDL" style="margin-top:6px; font-size:11px; color:var(--text-sec);">0W 0D 0L</div></div>
                <div class="stat-card"><h3>Goals Scored</h3><span class="val" id="dashTotalGoals">0</span></div>
                
                <div class="stat-card full-card" style="padding:20px; background:linear-gradient(135deg, #2a2a30 0%, #18181b 100%);">
                    <div style="flex:1">
                        <h3 style="color:#fbbf24;">Trophies</h3>
                        <span class="val" id="dashTrophies" style="font-size:24px;">0</span>
                    </div>
                    <div id="dashTrophyList" style="text-align:right;"></div>
                </div>
            </div>

            <div class="recent-section">
                <div class="section-title"><i class="fa fa-history"></i> Latest Matches</div>
                <div id="dashRecent"></div>
            </div>
        </div>
    </div>

    <!-- ========== SQUAD ========== -->
    <div id="squadPage" class="page-section">
        <div class="container">
            <button class="btn-add" id="addPlayerBtn"><i class="fa fa-plus-circle"></i> Register New Player</button>
            <div id="squadList" style="margin-top:25px;"></div>
        </div>
    </div>

    <!-- ========== MATCHES ========== -->
    <div id="matchesPage" class="page-section">
        <div class="container">
            <button class="btn-add" id="addMatchBtn" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);"><i class="fa fa-pen-nib"></i> New Match Report</button>
            <div id="matchList" style="margin-top:25px;"></div>
        </div>
    </div>

    <!-- ========== RECORDS ========== -->
    <div id="recordsPage" class="page-section">
        <div class="container">
            <div style="text-align:right; margin-bottom:20px;">
                <div class="filter-wrapper">
                    <select id="recordsFilter" class="custom-select"><option value="all">All-Time Statistics</option></select>
                    <i class="fa fa-chevron-down filter-icon"></i>
                </div>
            </div>

            <div class="stats-grid" style="margin-bottom:25px;">
                <div class="stat-card" style="padding:15px;"><span class="val" id="totalGoals" style="font-size:22px;">0</span><h3>Goals</h3></div>
                <div class="stat-card" style="padding:15px;"><span class="val" id="totalAssists" style="font-size:22px;">0</span><h3>Assists</h3></div>
                <div class="stat-card" style="padding:15px;"><span class="val" id="totalSaves" style="font-size:22px;">0</span><h3>Saves</h3></div>
                <div class="stat-card" style="padding:15px;"><span class="val" id="totalCS" style="font-size:22px;">0</span><h3>Cleansheet</h3></div>
            </div>
            
            <div style="background:linear-gradient(135deg, rgba(255,215,0,0.05) 0%, rgba(0,0,0,0) 100%); padding:20px; border-radius:20px; border:1px solid rgba(255,215,0,0.1); margin-bottom:25px;">
                <h3 style="margin:0 0 15px; font-size:11px; color:var(--gold); text-transform:uppercase; letter-spacing:1px; display:flex; align-items:center; gap:6px;"><i class="fa fa-star"></i> Hall of Fame</h3>
                <div style="display:flex; justify-content:space-between; text-align:center;">
                    <div style="flex:1;">
                        <i class="fa fa-medal" style="color:var(--success); font-size:20px; margin-bottom:8px; filter:drop-shadow(0 0 5px rgba(16,185,129,0.5));"></i>
                        <div style="font-weight:800; font-size:14px; color:#fff;" id="bestMOTM">-</div>
                        <div style="font-size:10px; color:var(--text-sec);">Top MOTM</div>
                    </div>
                    <div style="width:1px; background:var(--border);"></div>
                    <div style="flex:1;">
                        <i class="fa fa-crown" style="color:var(--gold); font-size:20px; margin-bottom:8px; filter:drop-shadow(0 0 5px rgba(255,215,0,0.5));"></i>
                        <div style="font-weight:800; font-size:14px; color:#fff;" id="bestMVP">-</div>
                        <div style="font-size:10px; color:var(--text-sec);">Top MVP</div>
                    </div>
                </div>
            </div>

            <div class="tab-nav">
                <button class="tab-btn active" onclick="switchRecordTab('goals', this)">Top Scorers</button>
                <button class="tab-btn" onclick="switchRecordTab('assists', this)">Top Assists</button>
                <button class="tab-btn" onclick="switchRecordTab('saves', this)">Top Saves</button>
            </div>

            <div id="goalsTab" class="record-container active"></div>
            <div id="assistsTab" class="record-container" style="display:none;"></div>
            <div id="savesTab" class="record-container" style="display:none;"></div>
            
            <div style="margin-top:30px; padding-top:20px; border-top:var(--border);">
                 <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                     <h3 style="margin:0; font-size:12px; color:var(--text-sec); text-transform:uppercase; font-weight:800;">Club Honors</h3>
                     <button onclick="openTrophyModal()" style="background:rgba(59,130,246,0.1); border:none; color:var(--primary); font-size:10px; font-weight:700; cursor:pointer; padding:6px 12px; border-radius:20px;">+ ADD</button>
                 </div>
                 <div id="trophyList"></div>
            </div>
        </div>
    </div>

    <!-- ========== MODALS ========== -->

    <!-- Player Modal -->
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <h3 id="playerModalTitle">Player Profile</h3>
            <form id="playerForm">
                <input type="hidden" id="playerId">
                <div style="margin-bottom:15px;">
                    <label style="font-size:11px; color:var(--text-sec); font-weight:700; text-transform:uppercase; margin-bottom:6px; display:block;">Full Name</label>
                    <input type="text" id="playerName" placeholder="e.g. Lautaro Martinez" required>
                </div>
                <div style="margin-bottom:20px;">
                    <label style="font-size:11px; color:var(--text-sec); font-weight:700; text-transform:uppercase; margin-bottom:6px; display:block;">Positions</label>
                    <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:8px;">
                        <div class="p-chip pos-opt" data-val="GK">GK</div>
                        <div class="p-chip pos-opt" data-val="DF">DF</div>
                        <div class="p-chip pos-opt" data-val="MF">MF</div>
                        <div class="p-chip pos-opt" data-val="FW">FW</div>
                    </div>
                </div>
                <button type="submit" class="btn-save">Save Profile</button>
                <button type="button" onclick="closeModal('playerModal')" class="btn-cancel btn-save">Dismiss</button>
            </form>
        </div>
    </div>

    <!-- Match Modal (UPDATED UI) -->
    <div id="matchModal" class="modal">
        <div class="modal-content">
            <h3 id="matchModalTitle">Match Report</h3>
            <form id="matchForm">
                <input type="hidden" id="matchId">
                
                <div style="display:grid; grid-template-columns:2fr 1fr; gap:10px; margin-bottom:15px;">
                    <div><input type="text" id="matchLeague" placeholder="League Name" required></div>
                    <div><input type="text" id="matchSeason" placeholder="Season" required></div>
                </div>

                <div style="margin-bottom:20px;">
                    <input type="text" id="matchOpponent" placeholder="Opponent Name" style="text-align:center; font-weight:700;" required>
                </div>

                <div class="score-input-group">
                    <div style="text-align:center;">
                        <input type="number" id="matchHome" placeholder="0" min="0" required>
                        <div style="font-size:10px; color:var(--text-sec); margin-top:5px; font-weight:700;">INTER</div>
                    </div>
                    <span style="font-weight:900; color:var(--text-dim); font-size:20px;">:</span>
                    <div style="text-align:center;">
                        <input type="number" id="matchAway" placeholder="0" min="0" required>
                        <div style="font-size:10px; color:var(--text-sec); margin-top:5px; font-weight:700;">AWAY</div>
                    </div>
                </div>

                <label style="margin-bottom:10px; display:block; font-size:11px; font-weight:700; color:var(--text-sec); letter-spacing:0.5px;">SQUAD SELECTION</label>
                <div id="playerPicker" class="player-picker-grid"></div>

                <div id="statsAreaWrapper" style="display:none;">
                    <label style="margin-bottom:10px; display:block; font-size:11px; font-weight:700; color:var(--text-sec); letter-spacing:0.5px;">PERFORMANCE DATA</label>
                    <div class="stats-input-area" id="statsArea"></div>
                    
                    <!-- NEW HERO SELECTION UI -->
                    <div class="hero-selection-container">
                        <!-- MOTM -->
                        <div class="hero-box motm">
                            <label style="color:var(--success)"><i class="fa fa-medal"></i> Match Hero (MOTM)</label>
                            <div class="hero-select-wrapper">
                                <div class="hero-display">
                                    <div class="hero-icon"><i class="fa fa-star"></i></div>
                                    <span class="hero-name" id="motmDisplay">Select Player</span>
                                </div>
                                <select id="motmSelect" onchange="window.updateGlobalSelect('motm', this)"></select>
                            </div>
                        </div>

                        <!-- MVP -->
                        <div class="hero-box mvp">
                            <label style="color:var(--gold)"><i class="fa fa-crown"></i> MVP</label>
                            <div class="hero-select-wrapper">
                                <div class="hero-display">
                                    <div class="hero-icon"><i class="fa fa-trophy"></i></div>
                                    <span class="hero-name" id="mvpDisplay">Select Player</span>
                                </div>
                                <select id="mvpSelect" onchange="window.updateGlobalSelect('mvp', this)"></select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn-save" style="margin-top:20px;">Save Match</button>
                <button type="button" onclick="closeModal('matchModal')" class="btn-cancel btn-save">Close</button>
            </form>
        </div>
    </div>

    <!-- Trophy Modal -->
    <div id="trophyModal" class="modal">
        <div class="modal-content">
            <h3>Add Honor</h3>
            <div style="margin-bottom:15px;"><input type="text" id="trophyName" placeholder="Competition Name"></div>
            <div style="margin-bottom:15px;"><input type="text" id="trophySeason" placeholder="Year / Season"></div>
            <div style="margin-bottom:20px;">
                <div class="filter-wrapper" style="width:100%;">
                    <select id="trophyRank" class="custom-select" style="width:100%; border-radius:12px;">
                        <option value="gold">ðŸ¥‡ Winner (Gold)</option>
                        <option value="silver">ðŸ¥ˆ Runner-up (Silver)</option>
                        <option value="bronze">ðŸ¥‰ 3rd Place (Bronze)</option>
                    </select>
                    <i class="fa fa-chevron-down filter-icon"></i>
                </div>
            </div>
            <button class="btn-save" onclick="saveTrophy()">Save Honor</button>
            <button class="btn-cancel btn-save" onclick="closeModal('trophyModal')">Cancel</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, doc, deleteDoc, updateDoc, getDoc, setDoc, increment, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAuqUcXYjMU-XaL_w7h4y43RHku4dQGFlk",
            authDomain: "inter-manila.firebaseapp.com",
            projectId: "inter-manila",
            storageBucket: "inter-manila.firebasestorage.app",
            messagingSenderId: "285507279342",
            appId: "1:285507279342:web:5aa0c80a08fb92727416ff"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let allMatches = [], allPlayers = [], playerData = {};
        let selectedPlayers = [], selectedPositions = [];
        let motmId = "", mvpId = "";

        const isLoggedIn = localStorage.getItem('inter_admin_auth') === 'true';
        
        if (isLoggedIn) {
            document.getElementById('loginOverlay').classList.add('hidden');
            initializeAdmin();
        } else {
            document.body.classList.remove('loading');
            document.getElementById('loadingScreen').style.display = 'none';
        }

        document.getElementById('loginForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('loginButton');
            const err = document.getElementById('loginError');
            
            btn.innerHTML = '<i class="fa fa-circle-notch fa-spin"></i> Checking...';
            err.style.display = 'none';
            
            try {
                await signInWithEmailAndPassword(auth, document.getElementById('loginEmail').value, document.getElementById('loginPassword').value);
                localStorage.setItem('inter_admin_auth', 'true');
                document.getElementById('loginOverlay').classList.add('hidden');
                document.getElementById('loadingScreen').style.display = 'flex';
                initializeAdmin();
            } catch (error) {
                btn.innerHTML = 'Sign In';
                err.style.display = 'block';
                err.innerText = "Access Denied: Invalid credentials.";
            }
        };

        document.getElementById('logoutBtn').onclick = () => {
            if(confirm("Secure Logout?")) {
                localStorage.removeItem('inter_admin_auth');
                signOut(auth);
                location.reload();
            }
        };

        function initializeAdmin() {
            loadData();
            setTimeout(() => {
                document.body.classList.remove('loading');
                document.getElementById('loadingScreen').style.display = 'none';
            }, 800);
        }

        window.navigateAdmin = (page) => {
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
            
            const map = { 'dashboard':0, 'squad':1, 'matches':2, 'records':3 };
            document.querySelectorAll('nav a')[map[page]].classList.add('active');
            
            setTimeout(() => {
                document.getElementById(page+'Page').classList.add('active');
                if(page === 'dashboard') renderDashboard();
                if(page === 'matches') renderMatches();
                if(page === 'records') renderRecords();
            }, 50);
        };

        function loadData() {
            onSnapshot(collection(db, "players"), snap => {
                allPlayers = snap.docs.map(d => ({id: d.id, ...d.data()}));
                allPlayers.forEach(p => playerData[p.id] = p);
                renderSquad(); renderRecords();
            });

            onSnapshot(query(collection(db, "matches"), orderBy("timestamp", "desc")), snap => {
                allMatches = snap.docs.map(d => ({id: d.id, ...d.data()}));
                updateFilters(); renderDashboard(); renderMatches(); renderRecords();
            });

            onSnapshot(query(collection(db, "trophies"), orderBy("timestamp", "desc")), snap => {
                renderTrophies(snap.docs.map(d => ({id: d.id, ...d.data()})));
            });
        }

        function updateFilters() {
            const seasons = [...new Set(allMatches.map(m => `${m.league} ${m.season}`.trim()))].sort();
            const opts = `<option value="all">All Seasons</option>` + seasons.map(s => `<option value="${s}">${s}</option>`).join('');
            document.getElementById('dashboardFilter').innerHTML = opts;
            document.getElementById('recordsFilter').innerHTML = opts;
        }

        function renderDashboard() {
            const filter = document.getElementById('dashboardFilter').value;
            const matches = filter === 'all' ? allMatches : allMatches.filter(m => `${m.league} ${m.season}`.trim() === filter);
            
            let w=0, d=0, l=0, goals=0;
            let dots = [], recents = "";

            matches.forEach((m, i) => {
                const h = parseInt(m.homeScore), a = parseInt(m.awayScore);
                goals += h;
                let res = h > a ? 'W' : (h < a ? 'L' : 'D');
                if(res === 'W') w++; else if(res === 'L') l++; else d++;
                
                if(dots.length < 5) dots.push(`<div class="dot dot-${res}"></div>`);
                
                if(i < 5) {
                    recents += `
                    <div class="activity-item">
                        <div class="team-info"><b>${m.opponent}</b><small>${m.league}</small></div>
                        <div class="score-pill" style="color:${res==='W'?'var(--success)':res==='L'?'var(--danger)':'var(--text-sec)'}">${h}-${a}</div>
                    </div>`;
                }
            });

            document.getElementById('dashWinRate').innerText = matches.length ? Math.round((w/matches.length)*100)+'%' : '0%';
            document.getElementById('dashMatches').innerText = matches.length;
            document.getElementById('dashWDL').innerText = `${w} Wins â€¢ ${d} Draws â€¢ ${l} Loss`;
            document.getElementById('dashTotalGoals').innerText = goals;
            document.getElementById('dashForm').innerHTML = dots.join('');
            document.getElementById('dashRecent').innerHTML = recents || '<div style="text-align:center; padding:20px; color:#555; font-size:12px;">No recent match activity.</div>';
            document.getElementById('seasonLabel').innerText = filter === 'all' ? "All-Time Records" : filter;
        }
        document.getElementById('dashboardFilter').onchange = renderDashboard;

        function renderSquad() {
            const list = document.getElementById('squadList');
            const active = allPlayers.filter(p => p.active !== false).sort((a,b) => a.name.localeCompare(b.name));
            const inactive = allPlayers.filter(p => p.active === false);
            
            const pHTML = (p, act) => `
                <div class="player-card ${act?'':'inactive'}">
                    <div>
                        <span class="p-name">${p.name}</span>
                        <div>${(Array.isArray(p.pos)?p.pos:[p.pos]).map(x=>`<span class="pos-badge">${x}</span>`).join('')}</div>
                    </div>
                    <div class="player-actions">
                        <i class="fa fa-toggle-${act?'on':'off'}" style="color:${act?'var(--success)':'var(--text-dim)'}" onclick="togglePlayerStatus('${p.id}', ${act})"></i>
                        <i class="fa fa-pencil" onclick="editPlayer('${p.id}')"></i>
                        <i class="fa fa-trash" onclick="confirmDeletePlayer('${p.id}')"></i>
                    </div>
                </div>`;

            list.innerHTML = (active.length ? `<div style="margin-bottom:10px; font-size:11px; font-weight:700; color:var(--text-sec); letter-spacing:1px;">ACTIVE ROSTER</div>` + active.map(p => pHTML(p,true)).join('') : '') +
                             (inactive.length ? `<div style="margin:25px 0 10px; font-size:11px; font-weight:700; color:var(--text-sec); letter-spacing:1px;">ARCHIVED</div>` + inactive.map(p => pHTML(p,false)).join('') : '');
        }

        document.getElementById('addPlayerBtn').onclick = () => {
            document.getElementById('playerForm').reset();
            document.getElementById('playerId').value = "";
            document.getElementById('playerModalTitle').innerText = "Register Player";
            selectedPositions = [];
            document.querySelectorAll('.pos-opt').forEach(d => d.classList.remove('selected'));
            document.getElementById('playerModal').classList.add('active');
        };

        document.querySelectorAll('.pos-opt').forEach(el => {
            el.onclick = () => {
                const val = el.dataset.val;
                if(selectedPositions.includes(val)) {
                    selectedPositions = selectedPositions.filter(p => p !== val);
                    el.classList.remove('selected');
                } else {
                    selectedPositions.push(val);
                    el.classList.add('selected');
                }
            };
        });

        document.getElementById('playerForm').onsubmit = async (e) => {
            e.preventDefault();
            const id = document.getElementById('playerId').value;
            const data = {
                name: document.getElementById('playerName').value,
                pos: selectedPositions
            };
            
            if(!selectedPositions.length) return alert("Select at least one position");
            
            if(id) await updateDoc(doc(db, "players", id), data);
            else await addDoc(collection(db, "players"), {...data, active:true, goals:0, assists:0, saves:0, motm:0, mvp:0});
            
            closeModal('playerModal');
        };

        window.editPlayer = (id) => {
            const p = playerData[id];
            document.getElementById('playerId').value = id;
            document.getElementById('playerName').value = p.name;
            selectedPositions = Array.isArray(p.pos) ? p.pos : [p.pos];
            document.querySelectorAll('.pos-opt').forEach(d => {
                d.classList.toggle('selected', selectedPositions.includes(d.dataset.val));
            });
            document.getElementById('playerModalTitle').innerText = "Edit Profile";
            document.getElementById('playerModal').classList.add('active');
        };

        window.togglePlayerStatus = async (id, status) => { await updateDoc(doc(db, "players", id), {active: !status}); };

        function renderMatches() {
            const div = document.getElementById('matchList');
            if(!allMatches.length) return div.innerHTML = '<div style="text-align:center; padding:40px; color:#555;">No matches recorded.</div>';
            
            div.innerHTML = allMatches.map(m => `
                <div class="match-card">
                    <div class="match-actions">
                        <i class="fa fa-pencil" onclick="editMatch('${m.id}')"></i>
                        <i class="fa fa-trash" style="color:var(--danger); background:rgba(239,68,68,0.1)" onclick="confirmDeleteMatch('${m.id}')"></i>
                    </div>
                    <div class="league-tag">${m.league} â€¢ ${m.season}</div>
                    <div class="score-row">
                        <div class="team-name">INTER</div>
                        <div class="agg-score">${m.homeScore}-${m.awayScore}</div>
                        <div class="team-name" style="text-align:right">${m.opponent}</div>
                    </div>
                    <div class="stats-box">
                        ${m.scorers && m.scorers.length ? m.scorers.map(s => (s.goals>0||s.assists>0||s.saves>0) ? `
                            <div class="stat-item">
                                <span class="stat-player">${s.name} 
                                    ${s.id === m.motmId ? '<i class="fa fa-medal" title="MOTM"></i>' : ''}
                                    ${s.id === m.mvpId ? '<i class="fa fa-crown" title="MVP"></i>' : ''}
                                </span>
                                <span>
                                    ${s.goals>0 ? `G:<b style="color:var(--primary)">${s.goals}</b>` : ''} 
                                    ${s.assists>0 ? `A:<b style="color:var(--text-sec)">${s.assists}</b>` : ''} 
                                    ${s.saves>0 ? `S:<b style="color:var(--warning)">${s.saves}</b>` : ''}
                                </span>
                            </div>` : '').join('') : '<div style="text-align:center; color:#555; font-size:11px;">No stats recorded</div>'}
                    </div>
                </div>
            `).join('');
        }

        document.getElementById('addMatchBtn').onclick = () => {
            document.getElementById('matchForm').reset();
            document.getElementById('matchId').value = "";
            document.getElementById('matchModalTitle').innerText = "New Match";
            selectedPlayers = [];
            motmId = "";
            mvpId = "";
            
            updateHeroUI(); // Reset visual selectors
            renderPlayerPicker();
            renderStatsArea();
            document.getElementById('matchModal').classList.add('active');
        };

        function renderPlayerPicker() {
            const active = allPlayers.filter(p => p.active !== false);
            document.getElementById('playerPicker').innerHTML = active.map(p => `
                <div class="p-chip ${selectedPlayers.find(x=>x.id===p.id)?'selected':''}" onclick="toggleMatchPlayer('${p.id}')">
                    <b>${(Array.isArray(p.pos)?p.pos[0]:p.pos)}</b> ${p.name.split(' ')[0]}
                </div>
            `).join('');
        }

        window.toggleMatchPlayer = (id) => {
            const idx = selectedPlayers.findIndex(x => x.id === id);
            if(idx > -1) {
                selectedPlayers.splice(idx, 1);
            } else {
                const p = playerData[id];
                selectedPlayers.push({ id: p.id, name: p.name, pos: p.pos, goals: 0, assists: 0, saves: 0 });
            }
            renderPlayerPicker();
            renderStatsArea();
        };

        function renderStatsArea() {
            const area = document.getElementById('statsArea');
            const wrapper = document.getElementById('statsAreaWrapper');
            const motmSel = document.getElementById('motmSelect');
            const mvpSel = document.getElementById('mvpSelect');
            
            if(selectedPlayers.length === 0) {
                wrapper.style.display = 'none';
                return;
            }
            wrapper.style.display = 'block';

            let html = selectedPlayers.map(p => `
                <div class="stat-row">
                    <span>${p.name}</span>
                    <input type="number" placeholder="G" value="${p.goals||''}" onchange="updateStat('${p.id}','goals',this.value)">
                    <input type="number" placeholder="A" value="${p.assists||''}" onchange="updateStat('${p.id}','assists',this.value)">
                    <input type="number" placeholder="S" value="${p.saves||''}" onchange="updateStat('${p.id}','saves',this.value)">
                </div>
            `).join('');
            
            area.innerHTML = html;

            // Populate Hero Selects
            const options = `<option value="">-- None --</option>` + 
                selectedPlayers.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
            
            motmSel.innerHTML = options;
            mvpSel.innerHTML = options;
            
            motmSel.value = motmId;
            mvpSel.value = mvpId;
            updateHeroUI();
        }

        window.updateStat = (id, key, val) => {
            const p = selectedPlayers.find(x => x.id === id);
            if(p) p[key] = parseInt(val) || 0;
        };
        
        window.updateGlobalSelect = (type, el) => {
            if(type === 'motm') motmId = el.value;
            if(type === 'mvp') mvpId = el.value;
            updateHeroUI();
        };

        // NEW: Visual Update for MOTM/MVP
        function updateHeroUI() {
            const mText = document.getElementById('motmDisplay');
            const vText = document.getElementById('mvpDisplay');
            
            if(motmId && playerData[motmId]) {
                mText.innerText = playerData[motmId].name;
                mText.classList.add('active');
            } else {
                mText.innerText = "Select Player";
                mText.classList.remove('active');
            }

            if(mvpId && playerData[mvpId]) {
                vText.innerText = playerData[mvpId].name;
                vText.classList.add('active');
            } else {
                vText.innerText = "Select Player";
                vText.classList.remove('active');
            }
        }

        window.editMatch = async (id) => {
            const m = allMatches.find(x => x.id === id);
            if(!m) return;
            
            document.getElementById('matchModalTitle').innerText = "Update Match";
            document.getElementById('matchId').value = id;
            document.getElementById('matchLeague').value = m.league;
            document.getElementById('matchSeason').value = m.season;
            document.getElementById('matchOpponent').value = m.opponent;
            document.getElementById('matchHome').value = m.homeScore;
            document.getElementById('matchAway').value = m.awayScore;
            
            selectedPlayers = m.scorers.map(s => ({...s}));
            motmId = m.motmId || "";
            mvpId = m.mvpId || "";

            renderPlayerPicker();
            renderStatsArea();
            document.getElementById('matchModal').classList.add('active');
        };

        document.getElementById('matchForm').onsubmit = async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            btn.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Saving...';
            
            const matchId = document.getElementById('matchId').value;

            // Revert Old Stats
            if(matchId) {
                const oldM = await getDoc(doc(db, "matches", matchId));
                if(oldM.exists()) {
                    const od = oldM.data();
                    for(let s of od.scorers) await updateDoc(doc(db,"players",s.id), {
                        goals: increment(-s.goals), assists: increment(-s.assists), saves: increment(-s.saves)
                    });
                    if(od.motmId) await updateDoc(doc(db,"players",od.motmId), {motm: increment(-1)});
                    if(od.mvpId) await updateDoc(doc(db,"players",od.mvpId), {mvp: increment(-1)});
                }
            }

            // Apply New Stats
            for(let p of selectedPlayers) {
                await updateDoc(doc(db,"players",p.id), {
                    goals: increment(p.goals), assists: increment(p.assists), saves: increment(p.saves)
                });
            }
            if(motmId) await updateDoc(doc(db,"players",motmId), {motm: increment(1)});
            if(mvpId) await updateDoc(doc(db,"players",mvpId), {mvp: increment(1)});

            const data = {
                league: document.getElementById('matchLeague').value,
                season: document.getElementById('matchSeason').value,
                opponent: document.getElementById('matchOpponent').value,
                homeScore: parseInt(document.getElementById('matchHome').value),
                awayScore: parseInt(document.getElementById('matchAway').value),
                scorers: selectedPlayers,
                motmId: motmId,
                mvpId: mvpId,
                timestamp: serverTimestamp()
            };

            if(matchId) await updateDoc(doc(db, "matches", matchId), data);
            else await addDoc(collection(db, "matches"), data);

            btn.innerHTML = 'Save Match';
            closeModal('matchModal');
        };

        function renderRecords() {
            const filter = document.getElementById('recordsFilter').value;
            const matches = filter === 'all' ? allMatches : allMatches.filter(m => `${m.league} ${m.season}`.trim() === filter);
            
            let pStats = {};
            let tG=0, tA=0, tS=0, tCS=0;

            allPlayers.forEach(p => pStats[p.id] = {name:p.name, goals:0, assists:0, saves:0});

            matches.forEach(m => {
                tG += parseInt(m.homeScore);
                if(parseInt(m.awayScore) === 0) tCS++;
                if(m.scorers) m.scorers.forEach(s => {
                    if(pStats[s.id]) {
                        pStats[s.id].goals += (s.goals||0);
                        pStats[s.id].assists += (s.assists||0);
                        pStats[s.id].saves += (s.saves||0);
                        tA += (s.assists||0);
                        tS += (s.saves||0);
                    }
                });
            });

            document.getElementById('totalGoals').innerText = tG;
            document.getElementById('totalAssists').innerText = tA;
            document.getElementById('totalSaves').innerText = tS;
            document.getElementById('totalCS').innerText = tCS;
            
            const motmList = allPlayers.sort((a,b) => (b.motm||0)-(a.motm||0));
            const mvpList = allPlayers.sort((a,b) => (b.mvp||0)-(a.mvp||0));
            document.getElementById('bestMOTM').innerText = motmList[0]?.motm ? `${motmList[0].name.split(' ')[0]} (${motmList[0].motm})` : '-';
            document.getElementById('bestMVP').innerText = mvpList[0]?.mvp ? `${mvpList[0].name.split(' ')[0]} (${mvpList[0].mvp})` : '-';

            renderRankList('goalsTab', Object.values(pStats), 'goals');
            renderRankList('assistsTab', Object.values(pStats), 'assists');
            renderRankList('savesTab', Object.values(pStats), 'saves');
        }

        function renderRankList(id, list, key) {
            const sorted = list.filter(x => x[key] > 0).sort((a,b) => b[key] - a[key]);
            const max = sorted.length ? sorted[0][key] : 1;
            document.getElementById(id).innerHTML = sorted.length ? sorted.map((p,i) => `
                <div class="record-row">
                    <div class="bar" style="width:${(p[key]/max)*100}%"></div>
                    <span class="rank">#${i+1}</span>
                    <span class="rec-name">${p.name}</span>
                    <span class="rec-val">${p[key]}</span>
                </div>
            `).join('') : '<div style="text-align:center; padding:20px; color:#555; font-size:12px;">No stats available.</div>';
        }
        
        document.getElementById('recordsFilter').onchange = renderRecords;
        window.switchRecordTab = (tab, btn) => {
            document.querySelectorAll('.record-container').forEach(c => c.style.display = 'none');
            document.getElementById(tab+'Tab').style.display = 'block';
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        };

        function renderTrophies(list) {
            const div = document.getElementById('trophyList');
            const dash = document.getElementById('dashTrophyList');
            document.getElementById('dashTrophies').innerText = list.length;
            
            dash.innerHTML = list.slice(0,2).map(t => 
                `<div style="font-size:10px; color:#aaa; margin-bottom:2px;">
                    ${t.name} <b style="color:#fff">${t.season}</b>
                </div>`
            ).join('');

            div.innerHTML = list.length ? list.map(t => `
                <div style="display:flex; justify-content:space-between; align-items:center; background:var(--bg-card); padding:16px; border-radius:14px; margin-bottom:10px; border:var(--border);">
                    <div style="display:flex; align-items:center; gap:15px;">
                        <i class="fa fa-${t.rank=='silver'?'medal':t.rank=='bronze'?'award':'trophy'}" 
                           style="color:var(--${t.rank}); font-size:20px; filter:drop-shadow(0 0 8px var(--${t.rank}));"></i>
                        <div>
                            <div style="color:#fff; font-weight:700; font-size:14px;">${t.name}</div>
                            <div style="color:var(--text-sec); font-size:11px;">${t.season}</div>
                        </div>
                    </div>
                    <i class="fa fa-trash" style="color:#555; cursor:pointer;" onclick="confirmDeleteTrophy('${t.id}')"></i>
                </div>
            `).join('') : '<div style="text-align:center; color:#555; font-size:12px;">No honors added yet.</div>';
        }

        window.openTrophyModal = () => { document.getElementById('trophyModal').classList.add('active'); };
        window.saveTrophy = async () => {
            const data = {
                name: document.getElementById('trophyName').value,
                season: document.getElementById('trophySeason').value,
                rank: document.getElementById('trophyRank').value,
                timestamp: serverTimestamp()
            };
            await addDoc(collection(db, "trophies"), data);
            closeModal('trophyModal');
        };

        let deleteTargetId = null;
        let deleteType = null;

        window.confirmDeleteMatch = (id) => { deleteTargetId = id; deleteType = 'match'; showDeleteModal("Delete match report?"); };
        window.confirmDeletePlayer = (id) => { deleteTargetId = id; deleteType = 'player'; showDeleteModal("Archive player? Stats persist."); };
        window.confirmDeleteTrophy = (id) => { deleteTargetId = id; deleteType = 'trophy'; showDeleteModal("Remove trophy?"); };

        function showDeleteModal(msg) {
            document.getElementById('modalMessage').innerText = msg;
            document.getElementById('deleteModal').classList.add('active');
        }
        window.closeDeleteModal = () => { document.getElementById('deleteModal').classList.remove('active'); };

        document.getElementById('confirmDeleteBtn').onclick = async () => {
            if(!deleteTargetId) return;
            const btn = document.getElementById('confirmDeleteBtn');
            btn.innerHTML = '...';
            
            if(deleteType === 'match') {
                const docRef = doc(db, "matches", deleteTargetId);
                const snap = await getDoc(docRef);
                if(snap.exists()) {
                    const d = snap.data();
                    for(let s of d.scorers) await updateDoc(doc(db,"players",s.id), {
                        goals:increment(-s.goals), assists:increment(-s.assists), saves:increment(-s.saves)
                    });
                    if(d.motmId) await updateDoc(doc(db,"players",d.motmId), {motm:increment(-1)});
                    if(d.mvpId) await updateDoc(doc(db,"players",d.mvpId), {mvp:increment(-1)});
                    await deleteDoc(docRef);
                }
            }
            if(deleteType === 'player') await deleteDoc(doc(db, "players", deleteTargetId));
            if(deleteType === 'trophy') await deleteDoc(doc(db, "trophies", deleteTargetId));

            btn.innerHTML = 'Delete';
            closeDeleteModal();
        };

        window.closeModal = (id) => document.getElementById(id).classList.remove('active');
        window.onclick = (e) => { if(e.target.classList.contains('modal')) closeModal(e.target.id); };
    </script>
</body>
</html>